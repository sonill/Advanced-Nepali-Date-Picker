!function(e){var t=e("body"),a=new x;a.setCurrentDate();let n=a.nepaliYear+"-"+a.nepaliMonth+"-"+a.nepaliDate;e("form").attr("autocomplete","off");var s,l=1,d="",o=a.getNepaliYear(),h=a.getNepaliMonth(),r=2e3,p=2098,c=0,u="",_="",f="",g=[],v="",m="",y="win",D="",M="";function k(e){let t=e.split("-"),a=t[0]+"-";return a+=1==t[1].length?"0"+t[1]:t[1],a+="-",a+=1==t[2].length?"0"+t[2]:t[2],a}function Y(){let t=g.length;if(t<1)e(".andp-datepicker-container").removeClass("open").hide();else{if(g=g.sort((function(e,t){return(e=e.split("/").reverse().join(""))>(t=t.split("/").reverse().join(""))?1:e<t?-1:0})),c)D.attr("value",g[0]).val(g[0]).change();else{for(e('input.andp-hidden-dates[data-cal_id="'+d+'"]').remove(),i=0;i<=t-1;i++)I(g[i]);var a="";a=1==D.data("show_all_dates")?D.is(":input")?g.join(", "):"<span>"+g.join("</span><span>")+"</span>":t>1?t+" dates selected":g[0],D.is(":input")?D.attr("value",a).val(a):D.html(a)}e(".andp-datepicker-container").removeClass("open").hide(),selected_date=e(this).data("date")}}function E(){var t=D.offset(),a=D.outerHeight(),n=e(window).width(),i=D.outerWidth();if(e(".andp-datepicker-container").outerWidth()+t.left+10>n){var s=n-(t.left+i);e('.andp-datepicker-container[data-cal_id="'+d+'"]').css({top:t.top+a,right:s,left:"inherit"})}else e('.andp-datepicker-container[data-cal_id="'+d+'"]').css({top:t.top+a,left:t.left,right:"inherit"})}function w(){month=_.val(),year=u.val(),f.html("");var e=new x;e.setNepaliDate(year,month,1);var t=e.getDay(),a=C(year,month);append_html="";var n=1,s=1,l=parseInt(t)-2,d=1;for(i=1;i<=42;i++){last_month=parseInt(month)-1,last_year=parseInt(year),last_month<1&&(last_month=12,last_year-=1,last_year<r&&(last_year=r,last_month=1)),next_month=parseInt(month)+1,next_year=parseInt(year);var o=C(last_year,last_month);if(1==n&&(append_html+='<div class="andp-column">'),i<t)append_html+='<div class="old-dates"> '+parseInt(o-l)+" </div>",l-=1;else if(s<=a){let e=year+"-"+month+"-"+(s<10?"0"+s:s),t=g.indexOf(e);append_html+='<div class="day'+(t>=0?" selected":"")+'" data-date="'+e+'">'+s+"</div>",s++}else append_html+='<div  class="old-dates"> '+d+"</div>",d++;7==n&&(append_html+="</div>",n=0),n++}f.append(append_html)}function C(e,t){var a=new x;if(!(e<r||e>p||t<1||t>12)){e=e-r,t=t-1;return a.nepaliMonths[e][t]}}function N(e){e=e.split("-"),year=parseInt(e[0]),month=parseInt(e[1]);var t=parseInt(C(year,month));return day=parseInt(e[2])+1,day>t&&(day=1,month+=1,month>12&&(month=1,year+=1)),year+"-"+month+"-"+day}function b(t,a=!1){t=k(t);var n=g.indexOf(t),i=e('.andp-datepicker-container[data-cal_id="'+d+'"]').find('.day[data-date="'+t+'"]');a?i.addClass("soft-select"):n<0?(g.push(t),i.addClass("selected")):(g.splice(n,1),i.removeClass("selected"))}function I(e){M.append('<input class="andp-hidden-dates" type="hidden" data-cal_id="'+d+'" name="'+m+'[]" value="'+e+'">')}function x(){this.englishMonths=[31,28,31,30,31,30,31,31,30,31,30,31],this.englishLeapMonths=[31,29,31,30,31,30,31,31,30,31,30,31],this.nepaliMonths=[[30,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,31,32,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,31,29,30,30,29,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,31,32,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,31,29,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[30,32,31,32,31,30,30,30,29,30,30,30],[31,31,32,31,31,30,30,30,29,30,30,30],[31,31,32,31,31,30,30,30,29,30,30,30],[31,32,31,32,30,31,30,30,29,30,30,30],[30,32,31,32,31,30,30,30,29,30,30,30],[31,31,32,31,31,31,30,30,29,30,30,30],[30,31,32,32,30,31,30,30,29,30,30,30],[30,32,31,32,31,30,30,30,29,30,30,30],[30,32,31,32,31,30,30,30,29,30,30,30],[31,31,32,31,31,31,30,30,29,30,30,30],[30,31,32,32,31,30,30,30,29,30,30,30],[30,32,31,32,31,30,30,30,29,30,30,30],[31,31,32,31,31,30,30,30,29,30,30,30],[31,31,32,31,31,31,30,29,30,30,30,30],[30,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,30,30,30],[31,31,32,31,31,31,29,30,29,30,29,31],[31,31,32,31,31,31,30,29,29,30,30,30]],this.setCurrentDate=function(){var e=new Date;this.setEnglishDate(e.getFullYear(),e.getMonth()+1,e.getDate())},this.setEnglishDate=function(e,t,a){if(!this.isEnglishRange(e,t,a))throw new Exception("Invalid date format.");this.englishYear=e,this.englishMonth=t,this.englishDate=a,this.nepaliYear=2e3,this.nepaliMonth=1,this.nepaliDate=1;for(var n=this.getEnglishDateDifference(1943,4,14),i=0;n>=this.nepaliYearDays(i);)this.nepaliYear++,n-=this.nepaliYearDays(i),i++;for(var s=0;n>=this.nepaliMonths[i][s];)n-=this.nepaliMonths[i][s],this.nepaliMonth++,s++;this.nepaliDate=this.nepaliDate+n,this.getDay()},this.toEnglishString=function(e){return void 0===e&&(e="-"),this.englishYear+e+this.englishMonth+e+this.englishDate},this.getEnglishDateDifference=function(e,t,a){var n=this.countTotalEnglishDays(this.englishYear,this.englishMonth,this.englishDate)-this.countTotalEnglishDays(e,t,a);return n<0?-n:n},this.countTotalEnglishDays=function(e,t,a){for(var n=365*e+a,i=0;i<t-1;i++)n+=this.englishMonths[i];return n+=this.countleap(e,t)},this.countleap=function(e,t){return t<=2&&e--,Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)},this.isEnglishRange=function(e,t,a){return!(e<1944||e>2042)&&(!(t<1||t>12)&&!(a<1||a>31))},this.isLeapYear=function(e){return e%4==0&&(e%100!=0||e%400==0)},this.setNepaliDate=function(e,t,a){if(this.isNepaliRange(e,t,a)){this.nepaliYear=e,this.nepaliMonth=t,this.nepaliDate=a,this.englishYear=1944,this.englishMonth=1,this.englishDate=1;for(var n=this.getNepaliDateDifference(2e3,9,17);n>=(this.isLeapYear(this.englishYear)?366:365);)n-=this.isLeapYear(this.englishYear)?366:365,this.englishYear++;for(var i=this.isLeapYear(this.englishYear)?this.englishLeapMonths:this.englishMonths,s=0;n>=i[s];)this.englishMonth++,n-=i[s],s++;this.englishDate=this.englishDate+n,this.getDay()}else console.log("Invalid Date Format")},this.toNepaliString=function(e){return void 0===e&&(e="-"),this.nepaliYear+e+this.nepaliMonth+e+this.nepaliDate},this.getNepaliDateDifference=function(e,t,a){var n=this.countTotalNepaliDays(this.nepaliYear,this.nepaliMonth,this.nepaliDate)-this.countTotalNepaliDays(e,t,a);return n<0?-n:n},this.countTotalNepaliDays=function(e,t,a){var n=0;if(e<2e3)return 0;n+=a-1;for(var i=e-2e3,s=0;s<t-1;s++)n+=this.nepaliMonths[i][s];for(s=0;s<i;s++)n+=this.nepaliYearDays(s);return n},this.nepaliYearDays=function(e){for(var t=0,a=0;a<12;a++)t+=this.nepaliMonths[e][a];return t},this.isNepaliRange=function(e,t,a){return!(e<2e3||e>2098)&&(!(t<1||t>12)&&!(a<1||a>this.nepaliMonths[e-2e3][t-1]))},this.getDay=function(){var e=this.getEnglishDateDifference(1943,4,14);return this.weekDay=(3+e%7)%7+1,this.weekDay},this.getEnglishYear=function(){return this.englishYear},this.getEnglishMonth=function(){return this.englishMonth},this.getEnglishDate=function(){return this.englishDate},this.getNepaliYear=function(){return this.nepaliYear},this.getNepaliMonth=function(){return this.nepaliMonth},this.getNepaliDate=function(){return this.nepaliDate}}e.fn.nepaliDatePicker=function(){navigator.platform.toUpperCase().indexOf("MAC")>=0&&(y="mac"),e(this).each((function(){let t=e(this);e(this).attr("data-cal_id","cal-"+l),l++,e(this).addClass("andp-date-picker");var a=e.trim(e(this).attr("value"));let n=e(this).data("single");if(c=1==n||1==n?1:0,a&&!c){M=e(this).parents("form"),d=e(this).data("cal_id"),m=e(this).attr("name");let n=a.split(",");if(n.forEach((function(e,t){I(e.trim())})),1!=e(this).data("show_all_dates"))n.length>1?output_msg=n.length+" dates selected":output_msg=n[0],e(this).attr("value",output_msg);else if(!t.is("input")){let e="<span>"+a.split(",").join("</span><span>")+"</span>";t.append(e)}}})),e(this).click((function(){if(s=this,g=[],D=e(this),data_single=e(this).data("single"),c=1==data_single||1==data_single?1:0,d=e(this).data("cal_id"),function(a){e(".andp-datepicker-container").removeClass("open").hide();var n=e('.andp-datepicker-container[data-cal_id="'+d+'"]');if(n.length>0)return u=n.find(".andp-year-select"),_=n.find(".andp-month-select"),f=n.find(".andp-days-numbers"),n.addClass("open").show(),void E();var s='<div class="andp-datepicker-container" data-cal_id="'+d+'" >';s+='<div class = "andp-header">',s+='<button type = "button"  class = "andp-prev andp-change-months"> &#10094; </button>',s+='<select class = "andp-month-select"> </select>',s+='<select class = "andp-year-select"> </select>',s+='<button type = "button" class = "andp-next andp-change-months"> &#10095; </button> ',s+="</div>",s+='<div class="andp-body">',s+='<div class = "andp-days-names"> <div> SUN </div> <div> MON </div> <div> TUE </div> <div> WED </div> <div> THU </div> <div> FRI </div> <div> SAT </div> </div>',s+='<div class = "andp-days-numbers"> </div>',c||(control_key="mac"==y?"CMD":"CTRL",s+='<div class="andp-info" style="display:none"><i class="mdi mdi-information text-primary"></i> Press <strong>'+control_key+"</strong> or <strong>Shift</strong> key for multiple selection </div>");s+='<div class="andp-action-btns">',c||(s+='<button type="button" class="apply-date" data-cal_id="'+d+'">Apply</button>');for(s+="</div>",s+="</div>",s+="</div>",t.append(s),n=e('.andp-datepicker-container[data-cal_id="'+d+'"]'),u=n.find(".andp-year-select"),_=n.find(".andp-month-select"),f=n.find(".andp-days-numbers"),append_html='<option value = "01" '+("01"==h?"selected":" ")+" > Baisakh </option>",append_html+='<option value = "02" '+("02"==h?"selected":"")+" > Jestha </option>",append_html+='<option value = "03" '+("03"==h?"selected":"")+" > Asar </option>",append_html+='<option value = "04" '+("04"==h?"selected":"")+" > Shrawan </option>",append_html+='<option value = "05" '+("05"==h?"selected":"")+" > Bhadra </option>",append_html+='<option value = "06" '+("06"==h?"selected":"")+" > Ashoj </option>",append_html+='<option value = "07" '+("07"==h?"selected":"")+" > Kartik </option>",append_html+='<option value = "08" '+("08"==h?"selected":"")+" > Mangsir </option>",append_html+='<option value = "09" '+("09"==h?"selected":"")+" > Poush </option>",append_html+='<option value = "10" '+("10"==h?"selected":"")+" > Magh </option> ",append_html+='<option value = "11" '+("11"==h?"selected":"")+" > Falgun </option>",append_html+='<option value = "12" '+("12"==h?"selected":"")+" > Chaitra </option>",_.append(append_html),i=r;i<=p;i++)append_html='<option value="'+i+'"',i==o&&(append_html+=" selected"),append_html+=">"+i+"</option>",u.append(append_html);w(),e('.andp-datepicker-container[data-cal_id="'+d+'"]').addClass("open"),E()}(),c)selected_date=k(e(this).val()),selected_date.length>0?(older_date_ar=selected_date.split("-"),_.val(older_date_ar[1]).change(),u.val(older_date_ar[0]).change(),b(selected_date)):b(n,!0);else{M=e(this).parents("form"),(m=e(this).attr("name"))?e(this).removeAttr("name","").attr("data-name",m):m=e(this).attr("data-name");var a=e('input.andp-hidden-dates[data-cal_id="'+d+'"]'),l=a.length;if(l>0)if(1==l)selected_date=k(a.eq(0).val()),older_date_ar=selected_date.split("-"),_.val(older_date_ar[1]).change(),u.val(older_date_ar[0]).change(),b(selected_date);else{older_date=e('input.andp-hidden-dates[data-cal_id="'+d+'"]');let t=older_date.length;older_date=k(older_date.eq(t-1).val()),older_date&&older_date.length>0&&(older_date_ar=older_date.split("-"),_.val(older_date_ar[1]).change(),u.val(older_date_ar[0]).change()),a.each((function(){b(k(e(this).val()))}))}else b(n,!0)}})),t.on("change",".andp-month-select, .andp-year-select",(function(){w()}))},t.on("click",".andp-datepicker-container.open .andp-change-months",(function(t){selected_month=parseInt(_.val()),selected_year=parseInt(u.val()),e(this).hasClass("andp-next")?(selected_month+=1,selected_month>12&&(selected_month=1,selected_year+=1,selected_year>p&&(selected_year=p,selected_month=12))):(selected_month-=1,selected_month<1&&(selected_month=12,selected_year-=1,selected_year<r&&(selected_year=r,selected_month=1))),selected_month<10&&(selected_month="0"+selected_month),selected_year<10&&(selected_year="0"+selected_year),_.val(selected_month).change(),u.val(selected_year).change()})),t.on("click",".andp-datepicker-container.open .andp-days-numbers .day",(function(t){selected_day=e(this).text(),selected_date=e(this).data("date");var a=e('.andp-datepicker-container[data-cal_id="'+d+'"]');if(c)g=[],a.find(".andp-column .day").removeClass("selected"),b(selected_date),a.find(".andp-info").hide(),Y();else if(t.shiftKey){var n=g.length;if(n>0){selected_date=e(this).data("date"),v=g[n-1];var l=function(e,t){e=e.split("-"),t=t.split("-");var a=new x;a.setNepaliDate(e[0],e[1],e[2]);var n=[a.getEnglishYear(),a.getEnglishMonth(),a.getEnglishDate()];a.setNepaliDate(t[0],t[1],t[2]);var i=[a.getEnglishYear(),a.getEnglishMonth(),a.getEnglishDate()],s=new Date(n[0],n[1],n[2]),l=new Date(i[0],i[1],i[2]);return s>l&&1}(selected_date,v)?v:selected_date,o=l,h=function(e,t){e=e.split("-"),t=t.split("-");var a=new x;return a.setNepaliDate(e[0],e[1],e[2]),a.getNepaliDateDifference(t[0],t[1],t[2])}(selected_date,v);for(g=[],a.find(".andp-column .day").removeClass("selected"),b(o),i=1;i<=h;i++)b(o=N(o))}}else t.ctrlKey||t.metaKey?b(selected_date):(g=[],a.find(".andp-column .day").removeClass("selected"),b(selected_date),a.find(".andp-info").show());e("document").trigger("andp_date_selected",[g,s])})),t.on("click",(function(t){var a=e(".andp-datepicker-container, .andp-date-picker");a.is(t.target)||0!==a.has(t.target).length||e(".andp-datepicker-container").removeClass("open").hide()})),t.on("click",".andp-datepicker-container.open .apply-date",(function(){Y()}))}(jQuery);
